# Typecho追番插件

#### 更新

- 1.0.0.204, 2020.4.22更新
	- 追番分页显示，每页30个
- 1.0.0.202, 2020.2.8更新
	- 兼容非伪静态站
- 1.0.0.201c, 2020.1.20更新
	- 进一步撤销了no-referrer标记
	- 现在番剧封面不直接从b站获取了，会保存到服务器供使用
- **注意：因为现在需要下载封面到服务器，所以设置好插件后应先访问一次以构建封面缓存。时间可能较长，耐心等待。**
- 1.0.0.201b, 2020.1.16更新
	- 新增：番剧块背景可选（主题默认背景或番剧封面背景）
	- 更新时，请禁用再启用一次
- 1.0.0.201, 2020.1.15更新
	- 图片和评论可以兼得了
	- 加载速度理论上每多45个追番可以提升2倍
	- 现在的封面链接使用https了

#### 项目介绍
插件基于[WikiBangumi](https://www.wikimoe.com/?post=136)(原作者 广树)修改而成，将获取信息的来源更改为B站账户。

#### 修改内容

|      项目       |                 原插件                 |                    修改后                    |
| :-------------: | :------------------------------------: | :------------------------------------------: |
|       api       |                Bangumi                 |                   Bilibili                   |
| 设置项/登录方式 |               账号、密码               |                 UID、cookie                  |
|    追番信息     | 中文番剧名、外文番剧名、首播日期、进度 | 中文番剧名、最后更新的剧集名、首播日期、进度 |
|   进度条-文字   |             10/13、5/未知              |    已看完第13话/共 13 话、看到PV1/未完结     |
|       css       |                   …                    |                      …                       |
|      函数       |                   …                    |                      …                       |

#### 使用方法

1. 克隆或下载
2. 解压到 `usr/plugins`，并重命名成`BilibiliBangumi`
3. Typecho后台，启用插件
4. 使用方法
	1. 参见 [WikimoeBangumi](https://www.wikimoe.com/?post=136)

#### 关于番剧封面

因为使用`no-referrer`总会间歇性的失效导致封面无法获取，所以从1.0.0.201c开始，封面获取逻辑更改了：

1. 新加入的番剧，第一次会邮优先去b站下载封面到服务器
2. 之后再访问，封面链接会自动更改到服务器上

所以在初次启用插件时，最好在设置好后自己先访问一次以完成封面下载工作。受限于服务器传输速度和追番数量，第一次访问加载的时间可能会很长，耐心等待封面下载完成即可。

---

#### 已知问题

详细说明：参考 [博客](https://www.bwsl.wang/csother/85.html)

效果：参考 [追番页](http://58.87.102.195/bangumi.html)

